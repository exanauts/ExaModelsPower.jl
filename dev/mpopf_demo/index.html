<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Multi-period OPF · ExaModelsPower.jl</title><meta name="title" content="Multi-period OPF · ExaModelsPower.jl"/><meta property="og:title" content="Multi-period OPF · ExaModelsPower.jl"/><meta property="twitter:title" content="Multi-period OPF · ExaModelsPower.jl"/><meta name="description" content="Documentation for ExaModelsPower.jl."/><meta property="og:description" content="Documentation for ExaModelsPower.jl."/><meta property="twitter:description" content="Documentation for ExaModelsPower.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/citations.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ExaModelsPower.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorial</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../opf_demo/">Static OPF</a></li><li class="is-active"><a class="tocitem" href>Multi-period OPF</a></li></ul></li><li><a class="tocitem" href="../opfs_doc/">OPF Formulations</a></li><li><a class="tocitem" href="../core/">API Manual</a></li><li><a class="tocitem" href="../ref/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorial</a></li><li class="is-active"><a href>Multi-period OPF</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Multi-period OPF</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="mpopf_demo"><a class="docs-heading-anchor" href="#mpopf_demo">Multi-period OPF</a><a id="mpopf_demo-1"></a><a class="docs-heading-anchor-permalink" href="#mpopf_demo" title="Permalink"></a></h1><p>The multi-period (MP) OPF can also be modeled in ExaModelsPower with a number of user-specified adjustments, including storage.</p><p>Some of the models in this portion of the tutorial involve using external files. While we provide the necessary code to access these additional files, you may view them <strong><a href="https://github.com/mit-shin-group/multi-period-opf-data">here</a></strong> as well. We will start with the simplest way to model the MPOPF, which also does not require the user to have any data already downloaded. Instead, the user specifies a demand curve for the system. The demand curve is a vector of ratios from 0 to 1 which indicate the scaling of demand compared to the demand indicated by the static OPF file. In this model of the MPOPF, every consuming bus has the same scaling in power demand for each point in time. A corrective action ratio, which limits the ramp rate of generators, can also be inputted. It is set to 0.1 as a default. The adjustable coordinate system and backend that were present for the static OPF are also available for all MPOPF models.</p><pre><code class="language-julia hljs">using ExaModelsPower, CUDA, MadNLP, MadNLPGPU, ExaModels
model, vars, cons = mpopf_model(
    &quot;pglib_opf_case118_ieee.m&quot;, # static network data
    [.64, .60, .58, .56, .56, .58, .64, .76, .87, .95, .99, 1.0, .99, 1.0, 1.0,
    .97, .96, .96, .93, .92, .92, .93, .87, .72, .64], #Demand curve
    backend = CUDABackend(),
    corrective_action_ratio = 0.3
)
result = madnlp(model; tol=1e-6)</code></pre><pre><code class="nohighlight hljs">&quot;Execution stats: Optimal Solution Found (tol = 1.0e-06).&quot;</code></pre><p>If the user would like to provide more complex demand profiles, they can provide their own input files. The number of rows in each input file should match the number of buses in the static OPF datafile, and the number of columns will dictate the number of time periods in the MP model. First, download the example load profile datafiles.</p><pre><code class="language-julia hljs">using Downloads

#Define URLs for Pd and Qd data files (raw or raw GitHub links)
pd_url = &quot;https://raw.githubusercontent.com/mit-shin-group/multi-period-opf-data/refs/heads/main/halfhour_30.Pd&quot;
qd_url = &quot;https://raw.githubusercontent.com/mit-shin-group/multi-period-opf-data/refs/heads/main/halfhour_30.Qd&quot;

#Define local paths to temporarily store the files
pd_file = &quot;halfhour_30.Pd&quot;
qd_file = &quot;halfhour_30.Qd&quot;

#Download the files if they don&#39;t already exist
if !isfile(pd_file)
    Downloads.download(pd_url, pd_file)
end

if !isfile(qd_file)
    Downloads.download(qd_url, qd_file);
end</code></pre><pre><code class="nohighlight hljs">&quot;halfhour_30.Qd&quot;</code></pre><p>Next, build the MPOPF model, providing the dynamic load data instead of a demand curve as input.</p><pre><code class="language-julia hljs">#Run your model
model, vars, cons = mpopf_model(
    &quot;pglib_opf_case30_ieee.m&quot;,  # static network data (assumed local or already handled)
    pd_file,                    # dynamic load data (Pd)
    qd_file;                    # dynamic load data (Qd)
    backend = CUDABackend()
)

#Solve
result = madnlp(model; tol=1e-6)

# MPOPF with storage</code></pre><pre><code class="nohighlight hljs">&quot;Execution stats: Optimal Solution Found (tol = 1.0e-06).&quot;</code></pre><p>The MPOPF model can also be constructed with storage considerations. We model storage using the model proposed in <strong><a href="https://arxiv.org/pdf/2004.14768">Geth, Coffrin, Fobes 2020</a></strong>. This requires inputting a modified datafile containing storage parameters. When modeling MPOPF with storage, all of the aforementioned tuneable parameters are still available. We also allow the user to specify whether or not to model the charging/discharging complementarity constraint. This is set to false by default to avoid potential numerical error.</p><pre><code class="language-julia hljs">#First, we download the modified datafile with storage parameters included.
#Define URL for the main datafile
stor_url = &quot;https://raw.githubusercontent.com/mit-shin-group/multi-period-opf-data/refs/heads/main/pglib_opf_case30_ieee_mod.m&quot;

#Define local path to temporarily store the file
stor_file = &quot;pglib_opf_case30_ieee_mod.m&quot;

#Download the file if it doesn&#39;t already exist
if !isfile(stor_file)
    Downloads.download(stor_url, stor_file);
end</code></pre><pre><code class="nohighlight hljs">&quot;pglib_opf_case30_ieee_mod.m&quot;</code></pre><p>Generate the model with your modified datafile. If the datafile contains storage parameters, ExaModelsPower will automatically recognize it and include the additional necessary constraints.</p><pre><code class="language-julia hljs">model, vars, cons = mpopf_model(
    stor_file, # static network data with storage parameters
    pd_file,                    # dynamic load data (Pd)
    qd_file;                    # dynamic load data (Qd)
    backend = CUDABackend(),
    storage_complementarity_constraint = false
)
result = madnlp(model; tol=1e-6)
result.objective</code></pre><pre><code class="nohighlight hljs">299068.0404892951</code></pre><p>ExaModelsPower also provides a secondary option to avoid dealing with complementarity constraints. The user can specify a function that computesloss in battery level as a smooth function of discharge rate and the storage devices thermal rating parameter. We provide an arbitrary example function to demonstrate the modeling capability.</p><pre><code class="language-julia hljs">function example_function(d, srating)
    return d + .2/srating*d^2
end;</code></pre><p>ExaModelsPower will automatically adjust the necessary constraints if one of the inputs provided is a function.</p><pre><code class="language-julia hljs">model, vars, cons = mpopf_model(
    stor_file, # static network data with storage parameters
    pd_file,                    # dynamic load data (Pd)
    qd_file,                    # dynamic load data (Qd)
    example_function;           # discharge function
    backend = CUDABackend(),
    storage_complementarity_constraint = false
)
result = madnlp(model; tol=1e-6)
result.objective</code></pre><pre><code class="nohighlight hljs">299044.3240453917</code></pre><p>Despite the example discharge function being generated somewhat arbitrarily, the resultant objective values remain quite close for both the smooth and piecewise charge/discharge functions.</p><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../opf_demo/">« Static OPF</a><a class="docs-footer-nextpage" href="../opfs_doc/">OPF Formulations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Thursday 26 June 2025 12:05">Thursday 26 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
